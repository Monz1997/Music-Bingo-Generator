<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Bingo Generator (4x4 Ultimate Mix)</title>

    <style>
        /* --- General Styles (Screen View) --- */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9; 
            color: #333;
            line-height: 1.6;
        }

        header, .controls, .playlist-section {
            max-width: 900px;
            margin: 0 auto 20px;
            text-align: center;
        }

        h1 {
            color: #333; 
            margin-bottom: 10px;
        }
        
        /* Removed .tabs styling as tabs are gone */

        button {
            padding: 10px 20px;
            margin: 5px;
            border: 1px solid #333;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            background-color: white;
            color: #333;
            transition: background-color 0.3s ease;
        }

        /* Differentiate the two main generation buttons */
        #generate-round-button {
            background-color: #333;
            color: white;
            font-weight: bold;
        }
        #generate-cards-button {
            background-color: #eee;
        }

        /* --- Bingo Card Container (Screen View) --- */
        #card-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px; 
            margin: 20px auto;
            max-width: 1200px; 
        }

        .bingo-card {
            border: 2px solid #333;
            width: 250px; 
            height: 250px; 
            display: flex;
            flex-direction: column;
            box-shadow: 0 5px 10px rgba(0,0,0,0.1); 
            background-color: white;
            border-radius: 4px;
            overflow: hidden; 
        }

        .card-title {
            background-color: #ddd; 
            color: #333;
            padding: 6px;
            text-align: center;
            font-size: 0.9em;
            font-weight: bold;
            flex-shrink: 0; 
            border-bottom: 1px solid #333;
        }

        /* --- 4x4 Grid Layout --- */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
            flex-grow: 1; 
        }

        .card-cell {
            border: 1px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 2px; 
            font-size: 0.65em; 
            line-height: 1.1;
            overflow: hidden;
            word-wrap: break-word; 
            box-sizing: border-box; 
        }

        .card-cell.free-space { 
            background-color: #ccc; 
            font-weight: bold;
            color: #333;
            font-size: 0.8em; 
        }

        /* --- Playlist Styles --- */
        .playlist-section {
            margin-top: 40px;
            border-top: 2px dashed #ccc;
            padding-top: 25px;
            text-align: left;
        }
        .playlist-section h2 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }
        #playlist-output {
            max-width: 700px;
            margin: 10px auto;
            padding: 0 20px; 
            list-style-type: decimal; 
            columns: 1; 
        }

        /* --- üñ®Ô∏è PRINT MEDIA QUERY: 6 Cards Per Page (4x4 Layout) --- */
        @media print {
            body {
                margin: 0;
                padding: 0;
                background-color: white;
                -webkit-print-color-adjust: exact; 
                print-color-adjust: exact;
                color: #000 !important;
            }

            /* Hide elements not needed for printing */
            header, .controls, footer, hr {
                display: none;
            }

            /* Card Container: 2 columns x 3 rows on A4 portrait page */
            #card-container {
                display: grid;
                grid-template-columns: repeat(2, 1fr); 
                grid-template-rows: repeat(3, 1fr); 
                width: 21cm; 
                height: 29.7cm; 
                margin: 0 auto; 
                gap: 0; 
                padding: 0.3cm; 
                box-sizing: border-box; 
                page-break-after: always;
            }

            .bingo-card {
                /* Sizing reduced to fit 6 cards per page */
                width: 9.5cm; 
                height: 8.8cm; 
                border: 1px solid #000; 
                border-radius: 0; 
                box-shadow: none; 
                margin: 0.2cm; 
                background-color: white !important; 
                page-break-inside: avoid; 
            }

            .card-title {
                padding: 3px; 
                font-size: 0.7em;
                background-color: white !important;
                color: #000 !important;
                border-bottom: 1px solid #000;
            }

            /* Grid layout for printing: 4 rows x 4 columns */
            .card-grid {
                grid-template-columns: repeat(4, 1fr);
                grid-template-rows: repeat(4, 1fr);
            }
            
            .card-cell {
                font-size: 0.55em; 
                padding: 1px; 
                border: 1px solid #000; 
                background-color: white !important;
                color: #000 !important;
            }

            .card-cell.free-space {
                background-color: #ddd !important; 
                color: #000 !important;
                font-weight: bold;
                font-size: 0.7em;
            }

            /* Playlist Section: Starts on a new page */
            .playlist-section {
                display: block;
                border-top: none; 
                padding-top: 0;
                page-break-before: always; 
                text-align: left;
                width: 100%; 
                box-sizing: border-box;
                padding: 1cm; 
            }
            .playlist-section h2 {
                color: #000 !important;
            }
            #playlist-output {
                columns: 2; 
                max-width: 100%; 
                font-size: 0.9em;
            }
            #playlist-output li {
                break-inside: avoid-column; 
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>üé∂ Music Bingo Generator ($4 \times 4$ Ultimate Mix)</h1>
        <p>Category: **The Ultimate Mix** | Total Songs: **277** | Cards per Round: **18**</p>
    </header>

    <div class="controls">
        <button id="generate-round-button">üÜï Generate **New Round** (New Playlist & Cards)</button>
        <button id="generate-cards-button">‚ôªÔ∏è Generate **New Cards** (Use Current Playlist)</button>
        <button onclick="window.print()">üñ®Ô∏è Print 6 Cards (4x4) per A4 Page</button>
    </div>

    <div id="card-container">
        </div>

    <section class="playlist-section">
        <h2>Master Playlist for Called Songs</h2>
        <ol id="playlist-output">
            </ol>
    </section>

    <script>
        // Global variables to store the master playlist
        let masterPlaylistSongs = [];
        let availableSongsPool = []; // Will store all 277 songs

        // --- EMBEDDED SONG DATA (All Songs Combined - 277 Total) ---
        // I have removed the specific genre tags (cat1, cat2, etc.) as they are no longer needed
        const SONG_DATA = {
            // --- Classic Rock Relaxation (77 Songs) ---
            "#9 Dream": { artist: "John Lennon" },
            "A Horse with No Name": { artist: "America" },
            "A Pillow of Winds": { artist: "Pink Floyd" },
            "Angie (Remastered 2009)": { artist: "The Rolling Stones" },
            "Beast Of Burden (Remastered 1994)": { artist: "The Rolling Stones" },
            "Bell Bottom Blues": { artist: "Derek & The Dominos" },
            "Black Water": { artist: "The Doobie Brothers" },
            "Blackbird (Remastered 2009)": { artist: "The Beatles" },
            "California Dreamin' (Single Version)": { artist: "The Mamas & The Papas" },
            "Can't Find My Way Home": { artist: "Blind Faith" },
            "Crazy Love (Van Morrison)": { artist: "Van Morrison" },
            "Crazy Love (Poco)": { artist: "Poco" },
            "Dark Sweet Lady": { artist: "George Harrison" },
            "Deacon Blues": { artist: "Steely Dan" },
            "Dirty Work": { artist: "Steely Dan" },
            "Does Anybody Really Know What Time It Is?": { artist: "Chicago" },
            "Dog & Butterfly": { artist: "Heart" },
            "Dreams (2004 Remaster)": { artist: "Fleetwood Mac" },
            "Everybody's Talkin' (From 'Midnight Cowboy')": { artist: "Harry Nilsson" },
            "Fearless": { artist: "Pink Floyd" },
            "For What It's Worth": { artist: "Buffalo Springfield" },
            "From Now On": { artist: "Supertramp" },
            "From the Beginning": { artist: "Emerson, Lake & Palmer" },
            "God Only Knows (Mono)": { artist: "The Beach Boys" },
            "Going to California (Remaster)": { artist: "Led Zeppelin" },
            "Goodbye Yellow Brick Road": { artist: "Elton John" },
            "Graceland": { artist: "Paul Simon" },
            "Hello It's Me": { artist: "Todd Rundgren" },
            "I‚Äôll Have to Say I Love You in a Song": { artist: "Jim Croce" },
            "I'm Not In Love": { artist: "10cc" },
            "If You Could Read My Mind": { artist: "Gordon Lightfoot" },
            "In My Life (Remastered 2009)": { artist: "The Beatles" },
            "It's Too Late": { artist: "Carole King" },
            "Knockin' On Heaven's Door": { artist: "Bob Dylan" },
            "Lady Stardust": { artist: "David Bowie" },
            "Lay, Lady, Lay": { artist: "Bob Dylan" },
            "Let 'Em In": { artist: "Paul McCartney & Wings" },
            "Let It Be (Remastered 2009)": { artist: "The Beatles" },
            "Lotta Love": { artist: "Nicolette Larson" },
            "Mona Lisas And Mad Hatters": { artist: "Elton John" },
            "My Sweet Lord": { artist: "George Harrison" },
            "Never Going Back Again (2004 Remaster)": { artist: "Fleetwood Mac" },
            "On And On": { artist: "Stephen Bishop" },
            "Ooh La La": { artist: "Faces" },
            "Our House": { artist: "Crosby, Stills, Nash & Young" },
            "Peaceful Easy Feeling": { artist: "Eagles" },
            "Pink Moon": { artist: "Nick Drake" },
            "Right Down the Line": { artist: "Gerry Rafferty" },
            "Ripple": { artist: "Grateful Dead" },
            "Sara": { artist: "Fleetwood Mac" },
            "Sara Smile": { artist: "Daryl Hall & John Oates" },
            "Scarborough Fair / Canticle": { artist: "Simon & Garfunkel" },
            "She's Always a Woman": { artist: "Billy Joel" },
            "She's Gone": { artist: "Daryl Hall & John Oates" },
            "Slip Slidin' Away": { artist: "Paul Simon" },
            "Something (Remastered 2009)": { artist: "The Beatles" },
            "Something in the Way She Moves": { artist: "James Taylor" },
            "Summer Breeze": { artist: "Seals and Crofts" },
            "Teach Your Children": { artist: "Crosby, Stills, Nash & Young" },
            "Thank You (Remaster)": { artist: "Led Zeppelin" },
            "The Air That I Breathe (2008 Remaster)": { artist: "The Hollies" },
            "The Long And Winding Road (2021 Mix)": { artist: "The Beatles" },
            "The Only Living Boy in New York": { artist: "Simon & Garfunkel" },
            "The Sound of Silence (Electric Version)": { artist: "Simon & Garfunkel" },
            "The Weight (Remastered 2000)": { artist: "The Band" },
            "Tin Man": { artist: "America" },
            "Tuesday's Gone": { artist: "Lynyrd Skynyrd" },
            "Undun (2024 Remaster)": { artist: "The Guess Who" },
            "Waterloo Sunset": { artist: "The Kinks" },
            "We Just Disagree": { artist: "Dave Mason" },
            "We've Got Tonight": { artist: "Bob Seger & The Silver Bullet Band" },
            "Wild Horses (2009 Mix)": { artist: "The Rolling Stones" },
            "Wild World (2020 Mix)": { artist: "Cat Stevens" },
            "Winter Time": { artist: "Steve Miller Band" },
            "You Can Call Me Al": { artist: "Paul Simon" },
            "You've Got a Friend": { artist: "Carole King" },
            "Your Song": { artist: "Elton John" },
            
            // --- 90s Rock (96 Songs) ---
            "Smells Like Teen Spirit": { artist: "Nirvana" },
            "November Rain": { artist: "Guns N' Roses" },
            "What's Up?": { artist: "4 Non Blondes" },
            "Losing My Religion": { artist: "R.E.M." },
            "Everlong": { artist: "Foo Fighters" },
            "Don't Speak": { artist: "No Doubt" },
            "Self Esteem (2008 Remaster)": { artist: "The Offspring" },
            "1979": { artist: "The Smashing Pumpkins" },
            "Basket Case": { artist: "Green Day" },
            "Under the Bridge": { artist: "Red Hot Chili Peppers" },
            "Black Hole Sun": { artist: "Soundgarden" },
            "All Star": { artist: "Smash Mouth" },
            "Fly Away": { artist: "Lenny Kravitz" },
            "Buddy Holly": { artist: "Weezer" },
            "Glycerine": { artist: "Bush" },
            "Cannonball": { artist: "The Breeders" },
            "Been Caught Stealing": { artist: "Jane's Addiction" },
            "Midlife Crisis": { artist: "Faith No More" },
            "Jeremy": { artist: "Pearl Jam" },
            "Song 2": { artist: "Blur" },
            "Killing In the Name": { artist: "Rage Against The Machine" },
            "You Could Be Mine": { artist: "Guns N' Roses" },
            "Motorcycle Emptiness": { artist: "Manic Street Preachers" },
            "Monkey Wrench": { artist: "Foo Fighters" },
            "Plush": { artist: "Stone Temple Pilots" },
            "Suck My Kiss": { artist: "Red Hot Chili Peppers" },
            "Come As You Are": { artist: "Nirvana" },
            "Bullet With Butterfly Wings": { artist: "The Smashing Pumpkins" },
            "Outshined": { artist: "Soundgarden" },
            "Alive": { artist: "Pearl Jam" },
            "Age of Panic (Git-O-Rama Mix)": { artist: "Senser" },
            "Digging the Grave": { artist: "Faith No More" },
            "Screamager": { artist: "Therapy?" },
            "Higher Ground (Remastered 2003)": { artist: "Red Hot Chili Peppers" },
            "Hobo Humpin' Slobo Babe": { artist: "Whale" },
            "Sabotage": { artist: "Beastie Boys" },
            "Alice What's the Matter?": { artist: "Terrorvision" },
            "This Is a Call": { artist: "Foo Fighters" },
            "All I Wanna Do": { artist: "Sheryl Crow" },
            "The Chemicals Between Us": { artist: "Bush" },
            "Lump": { artist: "The Presidents Of The United States Of America" },
            "A Design for Life (2016 Remastered Version)": { artist: "Manic Street Preachers" },
            "Pretty Fly (For A White Guy)": { artist: "The Offspring" },
            "Bulls On Parade": { artist: "Rage Against The Machine" },
            "Cherub Rock": { artist: "Smashing Pumpkins" },
            "Heart-Shaped Box": { artist: "Nirvana" },
            "Even Flow": { artist: "Pearl Jam" },
            "Don't Cry": { artist: "Guns N' Roses" },
            "No Rain": { artist: "Blind Melon" },
            "Lovin' Machine": { artist: "The Jon Spencer Blues Explosion" },
            "Everything About You": { artist: "Ugly Kid Joe" },
            "Kill Your Television": { artist: "Ned's Atomic Dustbin" },
            "Aeroplane": { artist: "Red Hot Chili Peppers" },
            "About A Girl": { artist: "Nirvana" },
            "You Oughta Know": { artist: "Alanis Morissette" },
            "Easy": { artist: "Faith No More" },
            "Today": { artist: "Smashing Pumpkins" },
            "Once": { artist: "Pearl Jam" },
            "Longview": { artist: "Green Day" },
            "Drive (Incubus)": { artist: "Incubus" },
            "Kevin Carter (Remastered Version)": { artist: "Manic Street Preachers" },
            "Runaway Train (2022 Remaster)": { artist: "Soul Asylum" },
            "Drive (R.E.M.)": { artist: "R.E.M." },
            "Perseverance": { artist: "Terrorvision" },
            "Remedy": { artist: "The Black Crowes" },
            "In Bloom": { artist: "Nirvana" },
            "Hard To Handle": { artist: "The Black Crowes" },
            "Stupid Girl": { artist: "Garbage" },
            "Civil War": { artist: "Guns N' Roses" },
            "Walkin' On The Sun": { artist: "Smash Mouth" },
            "Come Back Brighter": { artist: "Reef" },
            "Come Out and Play (2008 Remaster)": { artist: "The Offspring" },
            "Richard III": { artist: "Supergrass" },
            "I Think I'm Paranoid": { artist: "Garbage" },
            "Fell On Black Days": { artist: "Soundgarden" },
            "Celebrity Skin": { artist: "Hole" },
            "A Change Would Do You Good": { artist: "Sheryl Crow" },
            "Just A Girl": { artist: "No Doubt" },
            "Black": { artist: "Pearl Jam" },
            "Scar Tissue": { artist: "Red Hot Chili Peppers" },
            "Santa Monica": { artist: "Everclear" },
            "Lithium": { artist: "Nirvana" },
            "Semi-Charmed Life": { artist: "Third Eye Blind" },
            "My Own Worst Enemy": { artist: "Lit" },
            "Muscle Museum": { artist: "Muse" },
            "Butterfly": { artist: "Crazy Town" },
            "The Red": { artist: "Chevelle" },
            "Crazy (Aerosmith)": { artist: "Aerosmith" },
            "Nancy Boy": { artist: "Placebo" },
            "Mrs. Robinson (2022 Remastered Edition)": { artist: "The Lemonheads" },
            "(Everything I Do) I Do It For You (Classic Version)": { artist: "Bryan Adams" },
            "All Apologies (2013 Mix)": { artist: "Nirvana" },
            "I Don't Want to Miss a Thing (From 'Armageddon' Soundtrack)": { artist: "Aerosmith" },
            "Every You Every Me": { artist: "Placebo" },

            // --- 80s & 90s Pop Hits (100 Songs) ---
            "Billie Jean": { artist: "Michael Jackson" },
            "Take On Me": { artist: "a-ha" },
            "Girls Just Want to Have Fun": { artist: "Cyndi Lauper" },
            "Like a Prayer": { artist: "Madonna" },
            "Sweet Dreams (Are Made of This)": { artist: "Eurythmics" },
            "Wake Me Up Before You Go-Go": { artist: "Wham!" },
            "I Wanna Dance with Somebody (Who Loves Me)": { artist: "Whitney Houston" },
            "Livin' On A Prayer": { artist: "Bon Jovi" },
            "Don't Stop Believin'": { artist: "Journey" },
            "Africa": { artist: "TOTO" },
            "The Power of Love": { artist: "Huey Lewis & The News" },
            "Walking on Sunshine": { artist: "Katrina & The Waves" },
            "I Love Rock 'N Roll": { artist: "Joan Jett & The Blackhearts" },
            "Everybody Wants To Rule The World": { artist: "Tears For Fears" },
            "Footloose": { artist: "Kenny Loggins" },
            "Jesse's Girl": { artist: "Rick Springfield" },
            "Summer Of '69": { artist: "Bryan Adams" },
            "Holding Out for a Hero": { artist: "Bonnie Tyler" },
            "You Give Love A Bad Name": { artist: "Bon Jovi" },
            "Come On Eileen": { artist: "Dexys Midnight Runners" },
            "Maniac (From 'Flashdance')": { artist: "Michael Sembello" },
            "Karma Chameleon": { artist: "Culture Club" },
            "Faith": { artist: "George Michael" },
            "Ghostbusters": { artist: "Ray Parker Jr." },
            "Bust a Move": { artist: "Young MC" },
            "Electric Dreams": { artist: "P. Lion" },
            "The Look": { artist: "Roxette" },
            "Total Eclipse of the Heart": { artist: "Bonnie Tyler" },
            "Need You Tonight": { artist: "INXS" },
            "Always Something There to Remind Me": { artist: "Naked Eyes" },
            "I Want It That Way": { artist: "Backstreet Boys" },
            "...Baby One More Time": { artist: "Britney Spears" },
            "Vogue": { artist: "Madonna" },
            "Wonderwall": { artist: "Oasis" },
            "Gonna Make You Sweat (Everybody Dance Now)": { artist: "C+C Music Factory" },
            "Mambo No. 5 (A Little Bit of...)": { artist: "Lou Bega" },
            "Macarena (Bayside Boys Mix)": { artist: "Los Del R√≠o" },
            "Torn": { artist: "Natalie Imbruglia" },
            "Barbie Girl": { artist: "Aqua" },
            "Smash Mouth - All Star": { artist: "Smash Mouth" },
            "Genie In A Bottle": { artist: "Christina Aguilera" },
            "Save Tonight": { artist: "Eagle-Eye Cherry" },
            "Wannabe": { artist: "Spice Girls" },
            "Kiss Me": { artist: "Sixpence None The Richer" },
            "No Scrubs": { artist: "TLC" },
            "Livin' la Vida Loca": { artist: "Ricky Martin" },
            "One Week": { artist: "Barenaked Ladies" },
            "O.P.P.": { artist: "Naughty By Nature" },
            "Jump Around": { artist: "House Of Pain" },
            "I'm Too Sexy": { artist: "Right Said Fred" },
            "Achy Breaky Heart": { artist: "Billy Ray Cyrus" },
            "C'est La Vie": { artist: "B*Witched" },
            "Get the Party Started": { artist: "P!nk" },
            "Hey Ya!": { artist: "Outkast" },
            "Crazy In Love (feat. Jay-Z)": { artist: "Beyonc√©" },
            "Umbrella": { artist: "Rihanna ft. Jay-Z" },
            "Hips Don't Lie": { artist: "Shakira ft. Wyclef Jean" },
            "Since U Been Gone": { artist: "Kelly Clarkson" },
            "Mr. Brightside": { artist: "The Killers" },
            "Toxic": { artist: "Britney Spears" },
            "Gold Digger": { artist: "Kanye West ft. Jamie Foxx" },
            "Happy": { artist: "Pharrell Williams" },
            "Shut Up and Dance": { artist: "WALK THE MOON" },
            "Uptown Funk": { artist: "Mark Ronson ft. Bruno Mars" },
            "Call Me Maybe": { artist: "Carly Rae Jepsen" },
            "Rolling in the Deep": { artist: "Adele" },
            "Party Rock Anthem": { artist: "LMFAO ft. Lauren Bennett & GoonRock" },
            "Single Ladies (Put a Ring on It)": { artist: "Beyonc√©" },
            "Take Me Out": { artist: "Franz Ferdinand" },
            "Beautiful Day": { artist: "U2" },
            "Get Lucky": { artist: "Daft Punk ft. Pharrell Williams" },
            "Blurred Lines": { artist: "Robin Thicke ft. T.I. & Pharrell" },
            "Forget You": { artist: "CeeLo Green" },
            "Just Dance": { artist: "Lady Gaga ft. Colby O'Donis" },
            "Firework": { artist: "Katy Perry" },
            "Poker Face": { artist: "Lady Gaga" },
            "Tik Tok": { artist: "Ke$ha" },
            "I Gotta Feeling": { artist: "The Black Eyed Peas" },
            "Bad Romance": { artist: "Lady Gaga" },
            "Don't Stop The Music": { artist: "Rihanna" },
            "A Thousand Miles": { artist: "Vanessa Carlton" },
            "Dilemma": { artist: "Nelly ft. Kelly Rowland" },
            "Hanging By A Moment": { artist: "Lifehouse" },
            "In Da Club": { artist: "50 Cent" },
            "Hot In Herre": { artist: "Nelly" },
            "Whenever, Wherever": { artist: "Shakira" },
            "How You Remind Me": { artist: "Nickelback" },
            "Complicated": { artist: "Avril Lavigne" },
            "Ignition (Remix)": { artist: "R. Kelly" },
            "Where Is The Love?": { artist: "The Black Eyed Peas" },
            "Cry Me a River": { artist: "Justin Timberlake" },
            "Hey There Delilah": { artist: "Plain White T's" },
            "Stronger": { artist: "Kanye West" },
            "Bleeding Love": { artist: "Leona Lewis" },
            "Low": { artist: "Flo Rida ft. T-Pain" },
            "No One": { artist: "Alicia Keys" },
            "I'm Yours": { artist: "Jason Mraz" },
            "Disturbia": { artist: "Rihanna" },
            "Hot N Cold": { artist: "Katy Perry" },
            "Boom Boom Pow": { artist: "The Black Eyed Peas" },
            "Need You Now": { artist: "Lady A" },
            "Love The Way You Lie": { artist: "Eminem ft. Rihanna" },
            "Airplanes": { artist: "B.o.B ft. Hayley Williams" },
            "Just The Way You Are": { artist: "Bruno Mars" },
            "Grenade": { artist: "Bruno Mars" },
            "E.T.": { artist: "Katy Perry ft. Kanye West" },
            "Give Me Everything": { artist: "Pitbull ft. Ne-Yo, Afrojack & Nayer" },
            "Moves Like Jagger": { artist: "Maroon 5 ft. Christina Aguilera" },
            "We Found Love": { artist: "Rihanna ft. Calvin Harris" },
            "Somebody That I Used to Know": { artist: "Gotye ft. Kimbra" },
            "Thrift Shop": { artist: "Macklemore & Ryan Lewis ft. Wanz" },
            "Roar": { artist: "Katy Perry" },
            "Counting Stars": { artist: "OneRepublic" },
            "All of Me": { artist: "John Legend" },
            "Happy": { artist: "Pharrell Williams" },
            "Stay With Me": { artist: "Sam Smith" },
            "Blank Space": { artist: "Taylor Swift" },
            "Thinking Out Loud": { artist: "Ed Sheeran" },
            "See You Again": { artist: "Wiz Khalifa ft. Charlie Puth" },
            "Uptown Funk": { artist: "Mark Ronson ft. Bruno Mars" },
            "Cheerleader (Felix Jaehn Remix)": { artist: "OMI" },
            "Can't Feel My Face": { artist: "The Weeknd" },
            "Love Yourself": { artist: "Justin Bieber" },
            "One Dance": { artist: "Drake ft. Wizkid & Kyla" },
            "Closer": { artist: "The Chainsmokers ft. Halsey" },
            "Shape of You": { artist: "Ed Sheeran" },
            "Despacito (Remix)": { artist: "Luis Fonsi & Daddy Yankee ft. Justin Bieber" },
            "Humble.": { artist: "Kendrick Lamar" },
            "That's What I Like": { artist: "Bruno Mars" },
            "Perfect": { artist: "Ed Sheeran" },
            "Havana": { artist: "Camila Cabello ft. Young Thug" },
            "God's Plan": { artist: "Drake" },
            "Nice For What": { artist: "Drake" },
            "Better Now": { artist: "Post Malone" }
        };

        // --- Configuration for 4x4 Bingo Cards ---
        const CARD_COUNT = 18; 
        const CARD_SIZE = 15; 
        const FREE_SPACE_INDEX = 7; 
        const CATEGORY_NAME = 'The Ultimate Mix'; 

        /*
         * --- CORE UTILITY FUNCTIONS ---
         */

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function getAllSongs() {
            return Object.entries(SONG_DATA).map(([title, data]) => ({
                title,
                artist: data.artist,
                full_name: `${title} (${data.artist})`
            }));
        }


        /*
         * --- MAIN GENERATION LOGIC ---
         */
        
        // Function 1: Generates a NEW Master Playlist and Cards (New Round)
        function generateNewRound() {
            // 1. Get the pool of ALL songs
            availableSongsPool = getAllSongs();
            
            // 2. Determine the required number of songs for all card slots
            const requiredSongs = CARD_SIZE * CARD_COUNT; // 15 * 18 = 270
            
            if (availableSongsPool.length < requiredSongs) {
                alert(`Error: The Ultimate Mix only has ${availableSongsPool.length} unique songs. You need ${requiredSongs} to generate ${CARD_COUNT} unique 4x4 cards.`);
                return;
            }
            
            // 3. Shuffle the entire pool and slice the exact number of unique songs needed for all cards
            const shuffledSongs = shuffleArray([...availableSongsPool]);
            const songsForCards = shuffledSongs.slice(0, requiredSongs); 

            // 4. Extract the unique songs that actually made it onto the cards for the Master Playlist
            const uniqueMasterSongs = new Set(songsForCards.map(s => s.full_name));
            masterPlaylistSongs = Array.from(uniqueMasterSongs).map(fullName => ({ full_name: fullName }));

            // 5. Shuffle the master playlist for the calling order display
            masterPlaylistSongs = shuffleArray(masterPlaylistSongs);

            // 6. Generate the cards based on the sliced/shuffled songsForCards array
            generateCardsFromPool(songsForCards);

            // 7. Display the newly created Master Playlist
            displayMasterPlaylist();
        }

        // Function 2: Generates NEW Cards using the EXISTING Master Playlist
        function generateNewCards() {
            if (masterPlaylistSongs.length === 0) {
                // Should only happen on initial load, but good for safety
                generateNewRound();
                return;
            }
            
            const requiredSongs = CARD_SIZE * CARD_COUNT;
            
            // 1. Get the pool of unique song objects from the existing master playlist (songs already used)
            const distributionPool = masterPlaylistSongs.map(s => ({ full_name: s.full_name }));
            
            if (distributionPool.length < requiredSongs) {
                 alert(`Error: The current Master Playlist only contains ${distributionPool.length} unique songs, but ${requiredSongs} song slots are needed for ${CARD_COUNT} cards. Please click 'Generate New Round' to create a new, larger mix.`);
                 return;
            }

            // 2. Shuffle the existing unique songs and select the necessary number to fill all card slots (18 * 15 = 270)
            // Note: This ensures all 270 song slots are filled, pulling from the existing master list, even if it requires repeats.
            let songsForCards = [];
            let tempPool = [...distributionPool];
            while (songsForCards.length < requiredSongs) {
                if (tempPool.length === 0) {
                    tempPool = [...distributionPool]; // Reset the pool if it runs out (unlikely with this many songs)
                }
                const index = Math.floor(Math.random() * tempPool.length);
                songsForCards.push(tempPool.splice(index, 1)[0]);
            }
            
            // 3. Generate the new cards
            generateCardsFromPool(songsForCards);
            
            // The playlist display remains the same, only the cards are new.
        }
        
        // Common function to generate the 18 cards from a pre-determined song pool (songsForCards array must be 270 items long)
        function generateCardsFromPool(songsForCards) {
             const cardContainer = document.getElementById('card-container');
             cardContainer.innerHTML = '';
             
             for (let i = 0; i < CARD_COUNT; i++) {
                // Take the unique slice for this specific card
                const start = i * CARD_SIZE;
                const end = (i + 1) * CARD_SIZE;
                
                const cardSongsSegment = songsForCards.slice(start, end); 

                // Randomize the song positions *within* this card's set
                const cardSongs = shuffleArray(cardSongsSegment); 
                
                // Insert free space at the center position (index 7 for 4x4)
                cardSongs.splice(FREE_SPACE_INDEX, 0, { full_name: "üé∂ FREE SPACE üé∂", isFree: true });

                const card = document.createElement('div');
                card.className = 'bingo-card';
                
                const title = document.createElement('div');
                title.className = 'card-title';
                title.textContent = `${CATEGORY_NAME.toUpperCase()} BINGO CARD #${i + 1}`;
                card.appendChild(title);

                const grid = document.createElement('div');
                grid.className = 'card-grid';
                
                cardSongs.forEach(song => {
                    const cell = document.createElement('div');
                    cell.className = 'card-cell';
                    cell.textContent = song.full_name;
                    if (song.isFree) {
                        cell.classList.add('free-space');
                    }
                    grid.appendChild(cell);
                });

                card.appendChild(grid);
                cardContainer.appendChild(card);
            }
        }
        
        // Common function to display the master playlist
        function displayMasterPlaylist() {
            const playlistOutput = document.getElementById('playlist-output');
            playlistOutput.innerHTML = '';
            
            masterPlaylistSongs.forEach(song => {
                const listItem = document.createElement('li');
                listItem.textContent = song.full_name;
                playlistOutput.appendChild(listItem);
            });
        }


        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Generate initial cards and playlist
            generateNewRound();

            // 2. Attach event listeners
            document.getElementById('generate-cards-button').addEventListener('click', generateNewCards);
            document.getElementById('generate-round-button').addEventListener('click', generateNewRound);
        });
    </script>
</body>
</html>
